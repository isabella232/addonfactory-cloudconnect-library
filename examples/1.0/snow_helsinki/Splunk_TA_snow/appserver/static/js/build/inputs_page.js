webpackJsonp([2],{0:function(t,e,i){var n,s;n=[i("shim/jquery"),i("require/backbone"),i("splunkjs/mvc/headerview"),i(180),i(179),i(109)],s=function(t,e,n,s,a,o){var c=a.generatePublicPath,r=o.configManager,h=function(){var e=r.unifiedConfig,a=e&&e.name;i.p=c(a||"Splunk_TA_crowdstrike"),new n({id:"header",section:"dashboards",el:t(".preload"),acceleratedAppNav:!0}).render(),document.title="Inputs";var o=new s;o.render(),t(".addonContainer").html(o.el)};r.init(h)}.apply(e,n),!(void 0!==s&&(t.exports=s))},180:function(t,e,i){function n(t){return t&&t.__esModule?t:{default:t}}var s,a,o=i(109),c=i(127),r=i(181),h=i(144),l=n(h);s=[i("shim/jquery"),i(111),i("require/backbone"),i(133),i(132),i(182),i("models/Base"),i("views/shared/tablecaption/Master"),i(183),i(185),i(163),i(160)],a=function(t,e,i,n,s,a,h,p,d,u,g,f){return i.View.extend({className:"inputsContainer",initialize:function(t){var n=this;this.unifiedConfig=o.configManager.unifiedConfig,this.inputsPageTemplateData={},this.inputsPageTemplateData.title=this.unifiedConfig.pages.inputs.title,this.inputsPageTemplateData.description=this.unifiedConfig.pages.inputs.description,this.inputsPageTemplateData.singleInput=1===this.unifiedConfig.pages.inputs.services.length,this.addonName=this.unifiedConfig.meta.name,this.stateModel=new h,this.stateModel.set({sortKey:"name",sortDirection:"asc",count:10,offset:0,fetching:!0}),this.services=this.unifiedConfig.pages.inputs.services,this.filterKey=[],e.each(this.services,function(t){return e.each(t.entity,function(t){n.filterKey.indexOf(t.field)<0&&n.filterKey.push(t.field)})}),e.each(this.services,function(t){l.default[t.name]?n[t.name]=(0,c.generateCollection)("",{customizedUrl:l.default[t.name]}):n[t.name]=(0,c.generateCollection)(t.name)}),this.dispatcher=e.extend({},i.Events),this.listenTo(this.dispatcher,"filter-change",function(t){this.filterChange(t,this.stateModel)}.bind(this)),this.listenTo(this.dispatcher,"delete-input",function(){var t=this.fetchAllCollection();t.done(function(){var t,i=this.combineCollection(),n=this.stateModel.get("offset"),s=this.stateModel.get("count");this.cachedInputs=i[0],this.cachedSearchInputs=i[1],this.inputs.paging.set("offset",n),this.inputs.paging.set("perPage",s),this.inputs.paging.set("total",this.cachedSearchInputs.length),t=this.cachedSearchInputs.models.slice(n,n+s),e.each(t,function(t){t.paging.set("offset",n),t.paging.set("perPage",s),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(t),this.inputs._url=void 0}.bind(this))}.bind(this)),this.listenTo(this.dispatcher,"add-input",function(){var t=this.fetchAllCollection();t.done(function(){var t,i=this.combineCollection(),n=this.stateModel.get("offset"),s=this.stateModel.get("count");this.cachedInputs=i[0],this.cachedSearchInputs=i[1],this.inputs.paging.set("offset",n),this.inputs.paging.set("perPage",s),this.inputs.paging.set("total",this.cachedSearchInputs.length),t=this.cachedSearchInputs.models.slice(n,n+s),e.each(t,function(t){t.paging.set("offset",n),t.paging.set("perPage",s),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(t),this.inputs._url=void 0}.bind(this))}.bind(this)),this.listenTo(this.stateModel,"change:sortDirection change:sortKey",e.debounce(function(){void 0===this.inputs._url?this.sortCollection(this.stateModel):this.fetchListCollection(this.inputs,this.stateModel)}.bind(this),0)),this.listenTo(this.stateModel,"change:search",e.debounce(function(){void 0===this.inputs._url?this.searchCollection(this.stateModel):this.fetchListCollection(this.inputs,this.stateModel)}.bind(this),0)),this.listenTo(this.stateModel,"change:offset",e.debounce(function(){void 0===this.inputs._url?this.pageCollection(this.stateModel):this.fetchListCollection(this.inputs,this.stateModel)}.bind(this),0)),this.deferred=this.fetchAllCollection(),this.filter=new d({dispatcher:this.dispatcher,services:this.services}),this.emptySearchString=this.filterKey.map(function(t){return t+"=*"}).join(" OR ")},filterChange:function(t,i){i.set("offset",0,{silent:!0});var n,s,a,o=this.stateModel.get("search");"all"===t?void 0!==o&&o!==this.emptySearchString?(this.searchCollection(this.stateModel),this.inputs._url=void 0):(n=this.fetchAllCollection(),n.done(function(){var t=this.combineCollection(),i=this.stateModel.get("offset"),n=this.stateModel.get("count");this.cachedInputs=t[0],this.cachedSearchInputs=t[1],this.inputs.paging.set("offset",i),this.inputs.paging.set("perPage",n),this.inputs.paging.set("total",this.cachedSearchInputs.length),s=this.cachedSearchInputs.models.slice(i,i+n),e.each(s,function(t){t.paging.set("offset",i),t.paging.set("perPage",n),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(s),this.inputs._url=void 0}.bind(this))):(a=this.fetchListCollection(this[t],this.stateModel),a.done(function(){var e=this.services.find(function(e){return e.name===t});l.default[e.name]?this.inputs.model=(0,c.generateModel)("",{customizedUrl:l.default[e.name]}):this.inputs.model=(0,c.generateModel)(e.name),this.inputs._url=this[t]._url,this.inputs.reset(this[t].models);var i=this.stateModel.get("offset"),n=this.stateModel.get("count");this.inputs.paging.set("offset",i),this.inputs.paging.set("perPage",n),this.inputs.paging.set("total",this[t].paging.get("total"))}.bind(this)))},render:function(){var i=this,n=void 0;this.deferred.done(function(){i.stateModel.set("fetching",!1),n=i.combineCollection(),i.cachedInputs=n[0],i.cachedSearchInputs=n[1],i.inputs=i.combineCollection()[0],i.inputs.models=i.cachedInputs.models.slice(0,i.stateModel.get("count")),0!==i.inputs.length&&e.each(i.inputs.models,function(t){return t.paging.set("total",i.inputs.length)}),i.inputs.paging.set("total",i.inputs.length),i.caption=new p({countLabel:e(i.unifiedConfig.pages.inputs.title).t(),model:{state:i.stateModel},collection:i.inputs,noFilterButtons:!0,filterKey:i.filterKey}),i.inputTable=new f({stateModel:i.stateModel,collection:i.inputs,dispatcher:i.dispatcher,enableBulkActions:!1,showActions:!0,enableMoreInfo:!0,component:i.unifiedConfig.pages.inputs}),i.$el.append(e.template(a)(i.inputsPageTemplateData)),i.$el.append(i.caption.render().$el),i.inputsPageTemplateData.singleInput||t(".table-caption-inner").append(i.filter.render().$el),i.$el.append(i.inputTable.render().$el),i.inputsPageTemplateData.singleInput?i.$("#addInputBtn").on("click",function(){var e=new g({el:t(".dialog-placeholder"),collection:i.inputs,component:i.unifiedConfig.pages.inputs.services[0],isInput:!0}).render();e.modal()}):i.$("#addInputBtn").on("click",function(e){var n=t(e.currentTarget);return i.editmenu&&i.editmenu.shown?(i.editmenu.hide(),void e.preventDefault()):(i.editmenu=new u({collection:i.inputs,dispatcher:i.dispatcher,services:i.unifiedConfig.pages.inputs.services}),t("body").append(i.editmenu.render().el),void i.editmenu.show(n))})})},fetchAllCollection:function(){var i=this,n=new h;n.set({sortKey:"name",sortDirection:"asc",count:100,offset:0,fetching:!0});var s=e.map(this.services,function(t){return i.fetchListCollection(i[t.name],n)});return t.when.apply(this,s)},combineCollection:function(){var t=this,i=new s([],{appData:{app:this.addonName,owner:"nobody"},targetApp:this.addonName,targetOwner:"nobody"}),n=new s([],{appData:{app:this.addonName,owner:"nobody"},targetApp:this.addonName,targetOwner:"nobody"});return e.each(this.services,function(e){i.add(t[e.name].models,{silent:!0}),n.add(t[e.name].models,{silent:!0})}),[i,n]},fetchListCollection:function(t,e){var i="",n="";return e.get("search")&&(n=e.get("search"),i=n.substring(n.indexOf("*")+1,n.indexOf("*",n.indexOf("*")+1)).toLowerCase(),t._url.indexOf("ta_crowdstrike_falcon_host_inputs")>-1&&"falcon host".indexOf(i)>-1&&(n=this.emptySearchString),"disabled".indexOf(i)>-1?n+=' OR (disabled="*1*")':"enabled".indexOf(i)>-1&&(n+=' OR (disabled="*0*")')),e.set("fetching",!0),t.fetch({data:{sort_dir:e.get("sortDirection"),sort_key:e.get("sortKey"),search:n,count:e.get("count"),offset:e.get("offset")},success:function(){e.set("fetching",!1)}.bind(this)})},searchCollection:function(t){var i,n,s=this,a=t.get("search"),o=[],c=t.get("search"),r=this.stateModel.get("offset"),l=this.stateModel.get("count"),p=new h;a!==this.emptySearchString?(a=c.substring(c.indexOf("*")+1,c.indexOf("*",c.indexOf("*")+1)).toLowerCase(),o=this.cachedInputs.models.filter(function(t){return s.filterKey.some(function(e){var i=t.entry.get(e)&&t.entry.get(e).toLowerCase()||void 0,n=t.entry.content.get(e)&&t.entry.content.get(e).toLowerCase()||void 0;return i&&i.indexOf(a)>-1||n&&n.indexOf(a)>-1})}),this.inputs.paging.set("offset",r),this.inputs.paging.set("perPage",l),this.inputs.paging.set("total",o.length),e.each(o,function(t){t.paging.set("offset",r),t.paging.set("perPage",l),t.paging.set("total",o.length)}.bind(this)),this.cachedSearchInputs.reset(o),p.set({sortKey:"name",sortDirection:"asc",count:10,offset:0,fetching:!0}),this.pageCollection(p)):(i=this.fetchAllCollection(),i.done(function(){var t=this.combineCollection();this.cachedInputs=t[0],this.cachedSearchInputs=t[1],this.inputs.paging.set("offset",r),this.inputs.paging.set("perPage",l),this.inputs.paging.set("total",this.cachedSearchInputs.length),n=this.cachedSearchInputs.models.slice(r,r+l),e.each(n,function(t){t.paging.set("offset",r),t.paging.set("perPage",l),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(n),this.inputs._url=void 0,this.stateModel.get("search")!==this.emptySearchString&&this.searchCollection(this.stateModel)}.bind(this)))},pageCollection:function(t){var i,n=t.get("offset"),s=t.get("count");this.inputs.paging.set("offset",n),this.inputs.paging.set("perPage",s),this.inputs.paging.set("total",this.cachedSearchInputs.length),i=this.cachedSearchInputs.models.slice(n,n+s),e.each(i,function(t){t.paging.set("offset",n),t.paging.set("perPage",s),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(i)},sortCollection:function(t){var i=t.get("sortDirection"),n=t.get("sortKey"),s=this.fetchAllCollection(),a=t.get("offset"),o=t.get("count"),c=function(t,e){return(0,r.sortAlphabetical)(t.entry.get(n)||t.entry.content.get(n),e.entry.get(n)||e.entry.content.get(n),i)};s.done(function(){var t=this.combineCollection();this.cachedInputs=t[0],this.cachedSearchInputs=t[1],this.inputs.paging.set("offset",a),this.inputs.paging.set("perPage",o),this.inputs.paging.set("total",this.cachedSearchInputs.length),this.cachedSearchInputs.models.sort(c);var i=this.cachedSearchInputs.models.slice(a,a+o);e.each(i,function(t){t.paging.set("offset",a),t.paging.set("perPage",o),t.paging.set("total",this.cachedSearchInputs.length)}.bind(this)),this.inputs.reset(i),this.inputs._url=void 0}.bind(this))}})}.apply(e,s),!(void 0!==a&&(t.exports=a))},181:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.sortAlphabetical=function(t,e,i){t=t?t:"",e=e?e:"";var n=t<e?-1:t>e?1:0;return"asc"===i?n:-n},e.sortNumerical=function(t,e,i){t=t?t:0,e=e?e:0;var n=t<e?-1:t>e?1:0;return"asc"===i?n:-n}},182:function(t,e){t.exports='<div class ="tool-bar">\n    <div class ="tool-title"><%- _(title).t() %></div>\n    <div class = "tool-button">\n        <div class="dropdown add-button">\n            <button id="addInputBtn" class="btn btn-primary" type="button">\n                <%- _("Create New Input").t() %>\n                <% if (!singleInput) { %>\n                    <span class="caret"></span>\n                <% } %>\n            </button>\n        </div>\n    </div>\n    <div class= "tool-description">\n        <%- _(description).t() %>\n    </div>\n</div>\n<hr>\n'},183:function(t,e,i){var n,s;n=[i("shim/jquery"),i(111),i("require/backbone"),i(184)],s=function(t,e,i,n){return i.View.extend({className:"type-filter",events:{"mousedown a.dropdown-toggle":function(t){this.filter(t)},"keydown a.dropdown-toggle":function(t){13===t.which&&(this.filter(t),t.preventDefault())},"click a.dropdown-toggle":function(t){t.preventDefault()}},initialize:function(t){this.dispatcher=t.dispatcher,this.services=t.services,this.dispatcher.on("filter-change",function(t){this.changeType(t)}.bind(this))},render:function(){return this.$el.html(e.template(this.template)),this},changeType:function(i){var n=this.services.find(function(t){return t.name===i});this.$("a.dropdown-toggle").empty(),this.$("a.dropdown-toggle").append(e.template('<%- _("Service : ").t() %>')),"all"===i?this.$("a.dropdown-toggle").append(e.template('<%- _("All").t() %>')):this.$("a.dropdown-toggle").append(e.template(e(n.title).t())),this.$("a.dropdown-toggle").append(t('<span class="caret"></span>'))},filter:function(e){var i=t(e.currentTarget);return this.inputFilter&&this.inputFilter.shown?(this.inputFilter.hide(),void e.preventDefault()):(this.inputFilter=new n({dispatcher:this.dispatcher,services:this.services}),t("body").append(this.inputFilter.render().el),void this.inputFilter.show(i))},template:'\n            <a class="dropdown-toggle" href="#">\n                <%- _("Service : All").t() %><span class="caret"></span>\n            </a>\n        '})}.apply(e,n),!(void 0!==s&&(t.exports=s))},184:function(t,e,i){var n,s;n=[i("shim/jquery"),i(111),i("views/shared/PopTart")],s=function(t,e,i){return i.extend({className:"dropdown-menu",events:{"click a":"changeFilter"},initialize:function(t){i.prototype.initialize.apply(this,arguments),this.dispatcher=t.dispatcher,this.services=t.services},render:function(){var t='<ul class="first-group"><li><a href="#" class="all"><%- _("All").t() %></a></li></ul><ul class="second-group">';return e.each(this.services,function(i){t+='<li><a href="#" class="'+i.name+'">'+e(i.title).t()+"</a></li>"}),t+="</ul>",this.el.innerHTML=i.prototype.template_menu,this.$el.append(e.template(t)),this.$el.addClass("dropdown-menu-narrow"),this},changeFilter:function(e){this.hide();var i=t(e.target).attr("class");this.dispatcher.trigger("filter-change",i)}})}.apply(e,n),!(void 0!==s&&(t.exports=s))},185:function(t,e,i){var n,s,a=i(127);n=[i(111),i("shim/jquery"),i(133),i("views/shared/PopTart"),i(163),i(172)],s=function(t,e,i,n,s,o){return n.extend({className:"dropdown-menu",initialize:function(e){t.bindAll(this,"create"),n.prototype.initialize.apply(this,arguments),this.collection=e.collection,this.dispatcher=e.dispatcher,this.services=e.services,this.servers=(0,a.generateCollection)("account")},events:{"click a":"create"},render:function(){var e,i='<ul class="first-group">';for(e in this.services)this.services.hasOwnProperty(e)&&(i+='<li><a href="#" class="'+e+'">'+t(this.services[e].title).t()+"</a></li>");return i+="</ul>",this.el.innerHTML=n.prototype.template_menu,this.$el.append(i),this.$el.addClass("dropdown-menu-narrow"),this},create:function(t){var i,n;this.serviceType=e(t.target).attr("class"),"input"===this.serviceType?this.checkDependency().done(function(){0===this.servers.models.length?(n=new o({el:e(".dialog-placeholder"),msg:"Please add a Security Center Server first under configuration page."}),n.render().modal()):(i=new s({el:e(".dialog-placeholder"),collection:this.collection,component:this.services[this.serviceType],isInput:!0}).render(),i.modal())}.bind(this)):(i=new s({el:e(".dialog-placeholder"),collection:this.collection,component:this.services[this.serviceType],isInput:!0}).render(),i.modal()),this.hide()},checkDependency:function(){return e.when(this.servers.fetch())}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}});